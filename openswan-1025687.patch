diff -Naur openswan-2.6.32-orig/programs/_realsetup/_realsetup.in openswan-2.6.32/programs/_realsetup/_realsetup.in
--- openswan-2.6.32-orig/programs/_realsetup/_realsetup.in	2014-05-12 11:49:03.581038864 -0400
+++ openswan-2.6.32/programs/_realsetup/_realsetup.in	2014-05-12 11:54:55.380287727 -0400
@@ -394,17 +394,22 @@
 		rm -f  $OPENSWAN_RESOLV_CONF ";" \
 		"}"
 
-	# When we exit we clean up (remove) the modules we are using, even the kame'ish ones
+	# When we exit we clean up (remove) the NETKEY modules we are using,
+	# if we are switching to KLIPS 
 	if test -e ${kamepfkey}; then
+		if test -z "`ipsec addconn --configsetup |grep netkey`";
+		then
 		for mod in ipcomp ipcomp6 xfrm6_tunnel xfrm6_mode_tunnel xfrm6_mode_beet xfrm6_mode_ro \
 			xfrm6_mode_transport xfrm4_mode_transport xfrm4_mode_tunnel  xfrm_user \
 			xfrm4_tunnel xfrm4_mode_beet esp4 esp6 ah4 ah6 af_key
 		    do
 			lsmod 2>&1 | grep "^$mod" > /dev/null && rmmod  $mod
 		    done
+		fi
 	fi 
 
 	if test -e ${ipsecversion}; then
+		# always unload klips
 		lsmod 2>&1 | grep "ipsec" > /dev/null && rmmod  ipsec
 	fi
 
