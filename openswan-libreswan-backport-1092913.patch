diff -Naur openswan-2.6.32-orig/programs/ipsec/ipsec.in openswan-2.6.32/programs/ipsec/ipsec.in
--- openswan-2.6.32-orig/programs/ipsec/ipsec.in	2014-07-30 14:17:54.167976401 -0400
+++ openswan-2.6.32/programs/ipsec/ipsec.in	2014-07-30 15:28:45.095960186 -0400
@@ -20,6 +20,7 @@
 IPSEC_LIBDIR="${IPSEC_LIBDIR-@IPSEC_LIBDIR@}"
 IPSEC_SBINDIR="${IPSEC_SBINDIR-@IPSEC_SBINDIR@}"
 IPSEC_CONFS="${IPSEC_CONFS-@IPSEC_CONFS@}"
+IPSEC_CONFDDIR="${IPSEC_CONFDDIR-@IPSEC_CONFDDIR@}"
 
 IPSEC_DIR="$IPSEC_LIBDIR"
 export IPSEC_DIR IPSEC_CONFS IPSEC_LIBDIR IPSEC_EXECDIR
@@ -29,7 +30,7 @@
 export PATH
 
 # things not to be listed in --help command list
-DONTMENTION='^(ipsec|_.*|.*\.old|.*~)$'
+DONTMENTION='^(ipsec|_.*|.*\.old|.*\.orig|.*~)$'
 
 # version numbering (details filled in by build)
 # Possibly should call a C program to invoke the version_code() function
@@ -77,10 +78,24 @@
 	echo "See <http://www.openswan.org> for more general info."
 	exit 0
 	;;
+status|--status)
+	exec ipsec auto --status
+	;;
+start|--start)
+	exec ipsec setup start
+	;;
+stop|--stop)
+	exec ipsec setup stop
+	;;
+restart|--restart)
+	# restart does not work when stoped in systemd - it's dumb
+	ipsec setup stop
+	exec ipsec setup start
+	;;
 --help)
 	echo "Usage: ipsec command argument ..."
 	echo "where command is one of:"
-	for f in `ls $IPSEC_LIBDIR | egrep -v -i "$DONTMENTION"`
+	for f in start stop restart status import initnss checknss `ls $IPSEC_LIBDIR | egrep -v -i "$DONTMENTION"`
 	do
 		if test -x $IPSEC_LIBDIR/$f
 		then
@@ -89,7 +104,7 @@
 	done
 	echo
 	echo "Most of these have their own manual pages, e.g. ipsec_auto(8)."
-	echo "See also <http://www.freeswan.org> or the ipsec(8) manual page."
+	echo "See also <http://www.openswan.org> or the ipsec(8) manual page."
 	exit 0
 	;;
 version|--version)
@@ -119,6 +134,68 @@
 	echo "$IPSEC_CONFS"
 	exit 0
 	;;
+import|--import)
+	if [ $(id -u) -ne 0 ]; then
+		echo "permision denied on nss operation (must be superuser)"
+		exit 4
+	fi
+	if [ -z "${2}" ]; then
+		echo "usage: ipsec import /path/to/pkcs.12" >&2
+		exit 1
+	else
+		if [ ! -f "${2}" ]; then
+			echo "usage: ipsec import /path/to/pkcs.12"  >&2
+			exit 1
+		fi
+	fi
+	# this hardcoded ipsec.d needs to get fixed once we pass IPSECD properly
+	pk12util -i "${2}" -d "${IPSEC_CONFDDIR}"
+	if [ -x /usr/sbin/restorecon ]; then
+		restorecon -Rv "${IPSEC_CONFDDIR}"
+	fi
+	exit 0
+	;;
+initnss|--initnss|checknss|--checknss)
+	if [ $(id -u) -ne 0 ]; then
+		echo "permision denied on nss operation (must be superuser)"
+		exit 4
+	fi
+	if [ -n "${2}" ]; then
+		# A lot of nss commands use -d or --configdir to specify NSS db location
+		if [ "${2}" = "-d" -o "${2}" = "--configdir" ]; then
+			IPSEC_CONFDDIR="${3}"
+		else
+			IPSEC_CONFDDIR="${2}"
+		fi
+	fi
+	if [ ! -d "${IPSEC_CONFDDIR}" ]; then
+		mkdir -p "${IPSEC_CONFDDIR}"
+	fi
+	if [ -f "${IPSEC_CONFDDIR}/cert8.db" -o \
+	     -f "${IPSEC_CONFDDIR}/key3.db" -o \
+	     -f "${IPSEC_CONFDDIR}/secmod.db" ]; then
+	     # if just checking, silently quit
+		[ "${1}" = "checknss" -o "${1}" = "--checknss" ] && exit 0
+		echo "NSS database already initialised - aborted"
+		echo "To wipe the old NSS database, issue: rm \"${IPSEC_CONFDDIR}/\"*.db"
+		exit 42
+	fi
+
+	echo "Initializing NSS database"
+	echo "See 'man pluto' if you want to protect the NSS database with a password"
+	
+
+	TEMPFILE=$(/bin/mktemp "${IPSEC_CONFDDIR}/nsspw.XXXXXXX")
+	[ $? -gt 0 ] && TEMPFILE="${IPSEC_CONFDDIR}/nsspw.$$"
+	echo > ${TEMPFILE}
+	certutil -N -f "${TEMPFILE}" -d "${IPSEC_CONFDDIR}"
+	rm -f ${TEMPFILE}
+	if [ -x /usr/sbin/restorecon ]; then
+		restorecon -Rv "${IPSEC_CONFDDIR}"
+	fi
+	exit 0
+	;;
+
 --*)
 	echo "$0: unknown option \`$1' (perhaps command name was omitted?)" >&2
 	exit 1
diff -Naur openswan-2.6.32-orig/programs/_plutorun/_plutorun.in openswan-2.6.32/programs/_plutorun/_plutorun.in
--- openswan-2.6.32-orig/programs/_plutorun/_plutorun.in	2014-07-30 14:17:54.411982705 -0400
+++ openswan-2.6.32/programs/_plutorun/_plutorun.in	2014-07-30 15:26:17.096297494 -0400
@@ -65,6 +65,9 @@
 
 # initially we are in the foreground, with parent looking after logging
 
+# create nss if the admin deleted it or the packaging did not create it
+ipsec --checknss
+
 # precautions
 if test -f $pidfile
 then
