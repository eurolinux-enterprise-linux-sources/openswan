diff -Naur openswan-2.6.32-orig/programs/pluto/kernel_netlink.c openswan-2.6.32/programs/pluto/kernel_netlink.c
--- openswan-2.6.32-orig/programs/pluto/kernel_netlink.c	2014-06-22 15:19:10.284000000 -0400
+++ openswan-2.6.32/programs/pluto/kernel_netlink.c	2014-06-22 15:22:47.357000000 -0400
@@ -653,9 +653,14 @@
 	    src = req.u.p.sel.prefixlen_d;
 	    dst = req.u.p.sel.prefixlen_s;
 	}
-	req.u.p.priority = MIN_SPD_PRIORITY
-	    + (((2 << shift) - src) << shift)
-	    + (2 << shift) - dst;
+
+	req.u.p.priority = MIN_SPD_PRIORITY -
+		((policy == IPSEC_POLICY_NONE) ? 512 : 0) +
+		(((2 << shift) - src) << shift) +
+		(2 << shift) - dst - ((transport_proto) ? 64 : 0) -
+			((req.u.p.sel.sport) ? 32 : 0) -
+			((req.u.p.sel.sport) ? 32 : 0);
+
 
 	req.u.p.action = XFRM_POLICY_ALLOW;
 	if (policy == IPSEC_POLICY_DISCARD)
@@ -1906,9 +1906,9 @@
       snprintf(buf2, sizeof(buf2)
 	       , "eroute_connection %s inbound", opname);
 
-      return netlink_raw_eroute(&sr->this.host_addr, &sr->this.client
-			      , fam->any
-			      , &sr->that.client
+      return netlink_raw_eroute(&sr->that.host_addr, &sr->that.client
+			      , &sr->this.host_addr
+			      , &sr->this.client
 			      , htonl(spi)
 			      , SA_INT
 			      , sr->this.protocol
